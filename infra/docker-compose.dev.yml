# Development override for local Docker
# Uses development bot token (separate from Railway production bot)
# Usage: docker compose -f infra/docker-compose.yml -f infra/docker-compose.dev.yml up
# 
# IMPORTANT: Source .env.local before running:
#   export $(cat infra/.env.local | grep -v '^#' | xargs)
#   docker compose -f infra/docker-compose.yml -f infra/docker-compose.dev.yml up
#
# OR use the start-dev.sh script which does this automatically

services:
  api:
    working_dir: /app/packages/llama-api
    command: bun run dev
    env_file:
      - .env.local  # Use local dev env file
    environment:
      - NODE_ENV=development
      - LOG_LEVEL=debug

  bot:
    working_dir: /app/packages/llama-bot
    command: bun run dev
    # Explicitly override env_file to only use .env.local
    # Note: Docker Compose merges env_file, so we need to source .env.local first
    env_file:
      - .env.local  # Load dev bot credentials
    environment:
      - NODE_ENV=development
      - LOG_LEVEL=debug
      # Explicitly set Discord vars from environment (sourced from .env.local)
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - DISCORD_APP_ID=${DISCORD_APP_ID}
      - DISCORD_GUILD_ID=${DISCORD_GUILD_ID}
      - API_URL=http://api:3000

