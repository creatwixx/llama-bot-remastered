# Railway Docker Compose configuration
# This file is optimized for Railway deployment
# Railway will use this to deploy both services in the same network

services:
  api:
    build:
      context: ..
      dockerfile: infra/Dockerfile.api
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - PORT=${PORT:-3000}
      - API_PORT=${API_PORT:-3000}
      - NODE_ENV=production
      - LOG_LEVEL=${LOG_LEVEL:-info}
    # Railway handles port mapping automatically
    # No need to specify ports or networks - Railway manages this

  bot:
    build:
      context: ..
      dockerfile: infra/Dockerfile.bot
    environment:
      - DISCORD_TOKEN=${DISCORD_TOKEN}
      - DISCORD_APP_ID=${DISCORD_APP_ID}
      - DISCORD_GUILD_ID=${DISCORD_GUILD_ID}
      - DATABASE_URL=${DATABASE_URL}
      - REDIS_URL=${REDIS_URL}
      - API_URL=http://api:3000
      - NODE_ENV=production
      - LOG_LEVEL=${LOG_LEVEL:-info}
      - RAILWAY_ENVIRONMENT=true
    # Railway handles port mapping automatically
    # Services can communicate via service names (api, bot)

